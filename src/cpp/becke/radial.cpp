#include <lightspeed/becke.hpp>
#include <lightspeed/tensor.hpp>
#include "atomic_radii.hpp"
#include "../util/string.hpp"
#include <cmath>

namespace lightspeed {

size_t RadialGrid::size() const 
{
    return rw_->shape()[0];
}
std::shared_ptr<RadialGrid> RadialGrid::build(
    const std::string& name,
    size_t size,
    double a)
{
    if (name == "BECKE") {
        return RadialGrid::build_becke(size,a);
    } else if (name == "HANDY") {
        return RadialGrid::build_handy(size,a);
    } else if (name == "AHLRICHS") {
        return RadialGrid::build_ahlrichs(size,a);
    } else if (name == "KNOWLES") {
        return RadialGrid::build_knowles(size,a);
    } else if (name == "MULTIEXP") {
        return RadialGrid::build_multiexp(size,a);
    } else {
        throw std::runtime_error("RadialGrid: Unrecognized name.");
    }
}
std::shared_ptr<RadialGrid> RadialGrid::build_by_N(
    const std::string& name,
    size_t size,
    int N)
{
    if (name == "BECKE") {
        double a = AtomicRadii::becke_radius(N);
        return RadialGrid::build_becke(size,a);
    } else if (name == "HANDY") {
        double a = AtomicRadii::handy_radius(N);
        return RadialGrid::build_handy(size,a);
    } else if (name == "AHLRICHS") {
        double a = AtomicRadii::ahlrichs_radius(N);
        return RadialGrid::build_ahlrichs(size,a);
    } else if (name == "KNOWLES") {
        double a = AtomicRadii::knowles_radius(N);
        return RadialGrid::build_knowles(size,a);
    } else if (name == "MULTIEXP") {
        double a = AtomicRadii::multiexp_radius(N);
        return RadialGrid::build_multiexp(size,a);
    } else {
        throw std::runtime_error("RadialGrid: Unrecognized name.");
    }
}
std::shared_ptr<RadialGrid> RadialGrid::build_becke(
    size_t size,
    double a)
{
    // Directly uses cos(z), sin(z) for best accuracy
    std::vector<size_t> dim;
    dim.push_back(size);
    dim.push_back(2);
    std::shared_ptr<Tensor> rw(new Tensor(dim));
    double* rwp = rw->data().data();
    for (int i = 1; i <= size; i++) {
        double z = i * M_PI / (size + 1.0);
        double x = cos(z);
        double y = sin(z);
        double r = a * (1.0 + x) / (1.0 - x);
        double w = M_PI / (size + 1.0) * y * a * 2.0 / ((1.0 - x) * (1.0 - x)) * r * r;
        rwp[2*(size-i)+0] = r;
        rwp[2*(size-i)+1] = w;
    }
    return std::shared_ptr<RadialGrid>(new RadialGrid("BECKE",a,rw));
}
std::shared_ptr<RadialGrid> RadialGrid::build_handy(
    size_t size,
    double a)
{
    std::vector<size_t> dim;
    dim.push_back(size);
    dim.push_back(2);
    std::shared_ptr<Tensor> rw(new Tensor(dim));
    double* rwp = rw->data().data();
    for (int i = 1; i <= size; i++) {
        double x = i / (size + 1.0);
        double r = a * pow(x,2) / pow(1.0-x,2);
        double w = a * a * a * 2.0 * pow(x,5) / ((size + 1.0) * pow(1.0-x,7));
        rwp[2*(i-1)+0] = r;
        rwp[2*(i-1)+1] = w;
    }
    return std::shared_ptr<RadialGrid>(new RadialGrid("HANDY",a,rw));
}
std::shared_ptr<RadialGrid> RadialGrid::build_ahlrichs(
    size_t size,
    double a)
{
    // Directly uses cos(z), sin(z) for best accuracy
    const double alpha = 0.6;
    std::vector<size_t> dim;
    dim.push_back(size);
    dim.push_back(2);
    std::shared_ptr<Tensor> rw(new Tensor(dim));
    double* rwp = rw->data().data();
    for (int i = 1; i <= size; i++) {
        double z = i * M_PI / (size + 1.0);
        double x = cos(z);
        double y = sin(z);
        double u = log((1.0 - x) / 2.0);
        double v = pow(1.0 + x, alpha) / log(2.0);
        double r = - a * v * u;
        double w = M_PI / (size + 1.0) * y * a  * v * (-alpha * u / (1.0 + x) + 1.0 / (1.0 - x)) * r * r;
        rwp[2*(size-i)+0] = r;
        rwp[2*(size-i)+1] = w;
    }
    return std::shared_ptr<RadialGrid>(new RadialGrid("AHLRICHS",a,rw));
}
std::shared_ptr<RadialGrid> RadialGrid::build_knowles(
    size_t size,
    double a)
{
    std::vector<size_t> dim;
    dim.push_back(size);
    dim.push_back(2);
    std::shared_ptr<Tensor> rw(new Tensor(dim));
    double* rwp = rw->data().data();
    for (int i = 1; i <= size; i++) {
        double x = i / (size + 1.0);
        double u = log(1.0 - pow(x,3));
        double r = - a * u;
        double w = a * a * a * 3.0 * pow(x,2) * pow(u,2) / ((size + 1.0) * (1.0 - pow(x,3)));
        rwp[2*(i-1)+0] = r;
        rwp[2*(i-1)+1] = w;
    }
    return std::shared_ptr<RadialGrid>(new RadialGrid("KNOWLES",a,rw));
}
std::shared_ptr<RadialGrid> RadialGrid::build_multiexp(
    size_t size,
    double a)
{
    /**
     * Roots of polynomials orthogonal on [0,1]
     * w.r.t. the metric ln^2(x)
     *
     * From P.M.W. Gill, S.-H. Chien, J. Comput. Chem., 24, 732 (2003)
     * 
     * These were obtained from Peter Gill's website
     * https://rsc.anu.edu.au/~pgill/multiexp.php
     *
    
    1   0.125000000000000   2.000000000000000
    
    1   0.059850992523974   1.669136108179106
    2   0.453662520989539   0.330863891820894
    
    1   0.036263311146964   1.363830383647107
    2   0.273148602374171   0.565815459643824
    3   0.653711089636059   0.070354156709070
    
    1   0.024645131796122   1.133015642179986
    2   0.183193330997148   0.661216678605847
    3   0.461017107692196   0.185792949953630
    4   0.765590646563578   0.019974729260537
    
    1   0.017962448464788   0.958853796977194
    2   0.131718430619486   0.683002058455358
    3   0.339597192622686   0.281566027150624
    4   0.594598293478672   0.069585641223328
    5   0.832057599572553   0.006992476193496
    
    1   0.013730329045456   0.824737352390369
    2   0.099443147478445   0.670166203464709
    3   0.259667876215925   0.345795954949999
    4   0.468522989748694   0.126993601775933
    5   0.687424583530283   0.029455518788039
    6   0.874203776340771   0.002851368630950
    
    1   0.010866207505320   0.719152901447146
    2   0.077838279871025   0.642001756147696
    3   0.204687509451051   0.383963955676743
    4   0.376198829717809   0.178116619803947
    5   0.568389327329658   0.061674286979541
    6   0.753021289840870   0.013786206682459
    7   0.902433292255294   0.001304273262468
    
    1   0.008830809807049   0.634347612357608
    2   0.062647013654314   0.607890578339138
    3   0.165393747002955   0.403648557987985
    4   0.307647530932382   0.218465465723771
    5   0.473881164271694   0.095931949047165
    6   0.644925602762386   0.032063757135490
    7   0.800557615899960   0.006999794339627
    8   0.922202082495176   0.000652285069217
    
    1   0.007328880195715   0.565030790401789
    2   0.051547764155867   0.572402457821754
    3   0.136390198283372   0.410942571804823
    4   0.255769685793153   0.248113368613029
    5   0.399262221805764   0.127526643494220
    6   0.553560403203940   0.054151818128134
    7   0.703952669354882   0.017683406345981
    8   0.835889107857694   0.003798664022004
    9   0.936557217046754   0.000350279368267
    
    1   0.006186914698328   0.507510063239781
    2   0.043184964523230   0.537737088312751
    3   0.114393297847011   0.410158149857278
    4   0.215744326251233   0.268682157083323
    5   0.340016375817525   0.154453615234289
    6   0.477753066826457   0.076896476225321
    7   0.618154004584026   0.031926984063151
    8   0.750027750554594   0.010257845595189
    9   0.862765515603032   0.002178281995578
    10  0.947297511565912   0.000199338393338
    
    1   0.005297168366314   0.459147734919141
    2   0.036723005222904   0.504903008503401
    3   0.097323041240281   0.404218308313853
    4   0.184301719400151   0.282052866883149
    5   0.292518196160653   0.176276639025742
    6   0.415102577456842   0.098298114709767
    7   0.544017506575938   0.047892730337592
    8   0.670659374824876   0.019569787229519
    9   0.786485659409476   0.006213530125986
    10  0.883636267976582   0.001308240047822
    11  0.955536355773472   0.000119039904028
    
    1   0.004589693195255   0.418017824113410
    2   0.031623539733634   0.474301816818489
    3   0.083813985252297   0.395074643575296
    4   0.159194704226479   0.289909029375661
    5   0.254019121091356   0.193310690801472
    6   0.363194553791793   0.117340969898672
    7   0.480651247108805   0.064088547272520
    8   0.599734219851784   0.030743793563541
    9   0.713617876839584   0.012414739799576
    10  0.815726437770183   0.003906701704437
    11  0.900140606936052   0.000817207431179
    12  0.961991191180627   0.000074035645748
    
    1   0.004017386810443   0.382685775564930
    2   0.027526777614526   0.446025576834930
    3   0.072941331899235   0.384023972274008
    4   0.138851149246139   0.293622412458649
    5   0.222469426470852   0.206162603999141
    6   0.319951512542728   0.133655150470531
    7   0.426646611273461   0.079522892306238
    8   0.537360947246880   0.042784206315023
    9   0.646638294158882   0.020286445898623
    10  0.749049716936116   0.008118217047679
    11  0.839480441856746   0.002537058667903
    12  0.913402543012125   0.000528015651117
    13  0.967140495912293   0.000047672511229
    
    1   0.003547541993039   0.352063804257835
    2   0.024184699391199   0.420011622371769
    3   0.064061380204106   0.371926638924532
    4   0.122150405018770   0.294264224535848
    5   0.196341512203557   0.215502049342987
    6   0.283684337947141   0.147241937015533
    7   0.380565959543197   0.093629955712507
    8   0.482892583121109   0.054901932538534
    9   0.586283629455674   0.029203758845266
    10  0.686274808313256   0.013723262912334
    11  0.778523232293847   0.005453016087803
    12  0.859006678958644   0.001694853207356
    13  0.924210639223845   0.000351312263340
    14  0.971312969265969   0.000031631984358
    
    
    1   0.003156845392773   0.325313756517612
    2   0.021421742847487   0.396124356207930
    3   0.056715214649110   0.359352222870137
    4   0.108279002434823   0.292653698867661
    5   0.174489836879466   0.221958850827702
    6   0.253050105975383   0.158292685726503
    7   0.341116946761434   0.106146626096786
    8   0.435430905570579   0.066550172994835
    9   0.532453070244544   0.038592931968205
    10  0.628509787938396   0.020347552748834
    11  0.719941076797433   0.009493859649710
    12  0.803247767283529   0.003751144925081
    13  0.875232321594101   0.001160773201865
    14  0.933129879197034   0.000239821843717
    15  0.974740297547725   0.000021545553422
    
    1   0.002828300159798   0.301780476891072
    2   0.019110751099868   0.374198712979551
    3   0.050568668659265   0.346675898392731
    4   0.096636285322502   0.289410876220393
    5   0.156047462130955   0.226084387325758
    6   0.226989114165828   0.167080600854540
    7   0.307197679621559   0.117004667764872
    8   0.394052383477371   0.077390026028989
    9   0.484674055439231   0.047999891808212
    10  0.576029942951758   0.027594767061093
    11  0.665042420674438   0.014446574428494
    12  0.748698526989689   0.006702011552565
    13  0.824156928544244   0.002635892263672
    14  0.888849085545880   0.000812733709037
    15  0.940572876994778   0.000167465136962
    16  0.977589501930006   0.000015017582059
    
    1   0.002549268181483   0.280945189211177
    2   0.017157760439066   0.354063079756389
    3   0.045373808776699   0.334142213002512
    4   0.086771672296615   0.285002656880030
    5   0.140351489687455   0.228343528635447
    6   0.204665369064385   0.173900284191252
    7   0.277891281023551   0.126251800625624
    8   0.357902136731521   0.087238920904915
    9   0.442338317555793   0.057098628131991
    10  0.528684772985160   0.035114826064380
    11  0.614351643449972   0.020047111752487
    12  0.696756523837162   0.010435166524718
    13  0.773406135541422   0.004818355481427
    14  0.841975100464489   0.001887874661047
    15  0.900379750480077   0.000580362187371
    16  0.946846241320669   0.000119318281341
    17  0.979983398435209   0.000010683707891
    
    1   0.002310188032613   0.262392283299750
    2   0.015492096309324   0.335551049338251
    3   0.040943580985919   0.321907525033010
    4   0.078342213590741   0.279779774934759
    5   0.126889643277628   0.229119949034927
    6   0.185417079250863   0.179036252330030
    7   0.252443163436784   0.133998739377536
    8   0.326226163635375   0.096023028179669
    9   0.404818128973814   0.065674237156783
    10  0.486122442494718   0.042628774106851
    11  0.567954350784091   0.026037168698314
    12  0.648103328051837   0.014780307510249
    13  0.724395813272138   0.007657312937060
    14  0.794756734165206   0.003521927920280
    15  0.857268249207097   0.001375557344909
    16  0.910224382884338   0.000421812825376
    17  0.952181419425838   0.000086559395914
    18  0.982013901306222   0.000007740576331
    
    1   0.002103713861697   0.245785256334609
    2   0.014059758822520   0.318507057153833
    3   0.037134731295323   0.310068443540299
    4   0.071083378999791   0.274005366711849
    5   0.115261901980441   0.228726383232054
    6   0.168717532070917   0.182748199774754
    7   0.230234772687100   0.140385553704615
    8   0.298375567087281   0.103739776664728
    9   0.371520386749633   0.073598876921954
    10  0.447911795471924   0.049930263605688
    11  0.525700436623872   0.032192414617895
    12  0.602992768341327   0.019552542607783
    13  0.677899590280704   0.011046958150578
    14  0.748584276920761   0.005700569568147
    15  0.813309594947041   0.002613348432719
    16  0.870482031064796   0.001017968153145
    17  0.918692783605593   0.000311499200016
    18  0.956755632904915   0.000063820663927
    19  0.983750888184430   0.000005700961408
    
    1   0.001924123896548   0.230849018934113
    2   0.012818904308203   0.302788672475958
    3   0.033836058479442   0.298681032937715
    4   0.064788617704556   0.267876635676885
    5   0.105152759394186   0.227415866573449
    6   0.154144860255520   0.185265564670212
    7   0.210759108843122   0.145561250500400
    8   0.273798950815432   0.110430575318355
    9   0.341908732802284   0.080808744909874
    10  0.413607113229689   0.056876627612354
    11  0.487322401720604   0.038332342971330
    12  0.561429448570056   0.024578224251546
    13  0.634287460375067   0.014858188164593
    14  0.704277998456032   0.008361471530632
    15  0.769842365279614   0.004300377014631
    16  0.829517582062234   0.001965964030976
    17  0.881970217477923   0.000764052041239
    18  0.926027532208401   0.000233378737216
    19  0.960706355433472   0.000047750199250
    20  0.985248238975239   0.000004261449274
    
    1   0.001766905955418   0.217356699998702
    2   0.011736695821766   0.288267084421689
    3   0.030960181001045   0.287773876275508
    4   0.059294831367867   0.261541139618741
    5   0.096310990839680   0.225392242247653
    6   0.141358885591997   0.186787027524898
    7   0.193599713059551   0.149671985619717
    8   0.252030650182987   0.116161908835494
    9   0.315509567026290   0.087284943082145
    10  0.382780969115272   0.063376691720770
    11  0.452503451415981   0.044320019451470
    12  0.523278474766461   0.029707537861143
    13  0.593680061418344   0.018960092226938
    14  0.662284899256680   0.011416660413419
    15  0.727702291598452   0.006403135962611
    16  0.788603371442317   0.003283804612008
    17  0.843749010989284   0.001497647349735
    18  0.892015912851959   0.000580907132928
    19  0.932420552421345   0.000177161617223
    20  0.964141498191094   0.000036205480238
    21  0.986548031528898   0.000003228546969
    
    1   0.001628461746230   0.205119680180875
    2   0.010787067722103   0.274826646331061
    3   0.028437667614839   0.277357019193801
    4   0.054471898085992   0.255108995555831
    5   0.088534754664349   0.222819309409679
    6   0.130083417273674   0.187482444629131
    7   0.178413317623272   0.152854727798978
    8   0.232678321058697   0.121012705724115
    9   0.291910282420350   0.093038693466611
    10  0.355039425095198   0.069378785680193
    11  0.420915890810131   0.050057104798575
    12  0.488332391924356   0.034818658577368
    13  0.556047710367844   0.023232423316187
    14  0.622810692544012   0.014769464328093
    15  0.687384339963150   0.008863374800985
    16  0.748569572531227   0.004956761557497
    17  0.805228238209401   0.002535803622026
    18  0.856304959469968   0.001154123792461
    19  0.900847458207418   0.000446903172399
    20  0.938025164302648   0.000136110161355
    21  0.967146690015904   0.000027787723476
    22  0.987683509211338   0.000002476179303
    
    1   0.001505892474584   0.193979975198118
    2   0.009949112846861   0.262363963659648
    3   0.026212787562514   0.267428126763970
    4   0.050215014094684   0.248662024728409
    5   0.081660512821456   0.219828495609352
    6   0.120092694277137   0.187495823926848
    7   0.164915797166005   0.155234272915304
    8   0.215411397226014   0.125066174707640
    9   0.270754073298502   0.098100418872551
    10  0.330027592716307   0.074860364849399
    11  0.392241993524124   0.055477247414685
    12  0.456351572232027   0.039817159733692
    13  0.521273620526389   0.027571576765108
    14  0.585907670629421   0.018325604666402
    15  0.649154963911799   0.011611019656801
    16  0.709937833943106   0.006947749930384
    17  0.767218686284763   0.003875771461057
    18  0.820018260579743   0.001978563506850
    19  0.867432877982759   0.000898892530630
    20  0.908650423041717   0.000347557889758
    21  0.942964955771737   0.000105728680567
    22  0.969790557585917   0.000021565953939
    23  0.988681214124179   0.000001920578888
    
    1   0.001396841108628   0.183804351696878
    2   0.009205901459614   0.250786796254170
    3   0.024240389461507   0.257976738859653
    4   0.046439023937117   0.242260616648736
    5   0.075554710625806   0.216525156766932
    6   0.111200959344884   0.186948592457721
    7   0.152870900608033   0.156922256030170
    8   0.199950960142270   0.128404723657879
    9   0.251733554740276   0.102511933558023
    10  0.307430080774664   0.079819615070583
    11  0.366184581724246   0.060539452318891
    12  0.427088151776252   0.044633098352965
    13  0.489193986071764   0.031892422317387
    14  0.551532914108179   0.021999542986404
    15  0.613129212357411   0.014573473100979
    16  0.673016469852419   0.009206944902854
    17  0.730253269666416   0.005495349989307
    18  0.783938446986591   0.003058892932763
    19  0.833225690302863   0.001558645578986
    20  0.877337268846226   0.000707005965498
    21  0.915576710477130   0.000273010686377
    22  0.947340386377785   0.000082965226514
    23  0.972128607064410   0.000016909552383
    24  0.989562543370083   0.000001505087947
    
    1   0.001299374768187   0.174479735931546
    2   0.008543604574282   0.240012923532223
    3   0.022483579082068   0.248987218262273
    4   0.043074172979132   0.235948895302534
    5   0.070107468665480   0.212993687043331
    6   0.103254398760380   0.185942770543868
    7   0.142081248606511   0.158017307953912
    8   0.186061114941111   0.131106955278190
    9   0.234584307062143   0.106321004742672
    10  0.286968872412906   0.084268943142606
    11  0.342471629050440   0.065222155885247
    12  0.400299791724139   0.049217229847254
    13  0.459623147645393   0.036127743151150
    14  0.519586672291463   0.025717471448905
    15  0.579323439467549   0.017681582859112
    16  0.637967659284094   0.011679297675091
    17  0.694667666557350   0.007359910450342
    18  0.748598677599054   0.004383248044841
    19  0.798975134269998   0.002435209263362
    20  0.845062460733556   0.001238820802901
    21  0.886188073485450   0.000561155826571
    22  0.921751521808573   0.000216443029659
    23  0.951233755582807   0.000065714826168
    24  0.974206113448563   0.000013384402252
    25  0.990344899854832   0.000001190753989
    
    1   0.001211895953144   0.165909597900741
    2   0.007950835083421   0.229969050948748
    3   0.020911970701015   0.240440793791640
    4   0.040062890303616   0.229758620259279
    5   0.065227756094948   0.209301634430997
    6   0.096124873966381   0.184563873212425
    7   0.132381145124222   0.158605827354705
    8   0.173541771179187   0.133246033424505
    9   0.219078862911660   0.109577661754471
    10  0.268400049319685   0.088230076743001
    11  0.320857458070521   0.069518256800207
    12  0.375757171448330   0.053537150852984
    13  0.432369144701918   0.040226455838505
    14  0.489937515066220   0.029418139625084
    15  0.547691197495453   0.020873023457482
    16  0.604854644468783   0.014309796296644
    17  0.660658636490247   0.009428319627520
    18  0.714350964474867   0.005928277523599
    19  0.765206863851496   0.003523795966772
    20  0.812539062502577   0.001954429587142
    21  0.855707311124978   0.000992804711503
    22  0.894127278139190   0.000449166032353
    23  0.927278723938938   0.000173072023045
    24  0.954712978447157   0.000052504259616
    25  0.976060296284965   0.000010687185195
    26  0.991042553891775   0.000000950391839
    
    1   0.000938253265447   0.137676443941630
    2   0.006107726543114   0.195885975601622
    3   0.016031080676759   0.210268725136789
    4   0.030705186162534   0.206561492289121
    5   0.050036197942358   0.193856500144686
    6   0.073865597603489   0.176584044933802
    7   0.101979339965684   0.157256165869557
    8   0.134113324110492   0.137415766886845
    9   0.169957816772565   0.118046532595713
    10  0.209161640244516   0.099777943557785
    11  0.251336426144445   0.082999750605787
    12  0.296061051010481   0.067931912187925
    13  0.342886289952091   0.054670739318578
    14  0.391339685613067   0.043221425989051
    15  0.440930608618850   0.033522285387789
    16  0.491155473348428   0.025463611447442
    17  0.541503065266541   0.018902826458941
    18  0.591459931268120   0.013676886808064
    19  0.640515781563337   0.009612528011925
    20  0.688168850061483   0.006534705005718
    21  0.733931159722301   0.004273451964695
    22  0.777333639800269   0.002669310941103
    23  0.817931043294885   0.001577437115953
    24  0.855306615414549   0.000870468589335
    25  0.889076468144764   0.000440241650354
    26  0.918893624471120   0.000198433961056
    27  0.944451717719704   0.000076224316174
    28  0.965488410519963   0.000023066690603
    29  0.981789011002416   0.000004686380402
    30  0.993194470701601   0.000000416211557
    
    1   0.000710288160721   0.112092876985421
    2   0.004587102256450   0.163605423965229
    3   0.012012783293299   0.180057148429348
    4   0.022997219083556   0.181471124457663
    5   0.037494445348316   0.174971287793732
    6   0.055420399987502   0.164053261027971
    7   0.076658733330740   0.150722110311121
    8   0.101063934846327   0.136234748428706
    9   0.128463607203279   0.121420715568996
    10  0.158660460020927   0.106841864276382
    11  0.191434244320567   0.092880478278897
    12  0.226543722395174   0.079792025456380
    13  0.263728714255856   0.067738974224230
    14  0.302712236149867   0.056813802853714
    15  0.343202733087210   0.047055502143372
    16  0.384896399547925   0.038461968941276
    17  0.427479577789020   0.030999683895043
    18  0.470631220106360   0.024611510338003
    19  0.514025399364001   0.019223130211810
    20  0.557333850725481   0.014748441657154
    21  0.600228526610458   0.011094126050064
    22  0.642384146341758   0.008163519610316
    23  0.683480721674270   0.005859879132167
    24  0.723206039367624   0.004089102843288
    25  0.761258082155899   0.002761949813728
    26  0.797347369872117   0.001795790936293
    27  0.831199203116472   0.001115918869016
    28  0.862555792773512   0.000656441886258
    29  0.891178260062636   0.000360786261700
    30  0.916848494189018   0.000181832868912
    31  0.939370859849387   0.000081715613329
    32  0.958573761748160   0.000031311727232
    33  0.974311130330776   0.000009456588660
    34  0.986464197666822   0.000001918357355
    35  0.994946681075095   0.000000170197233
    
    1   0.000556967498706   0.093465963789691
    2   0.003573534297375   0.139195760758708
    3   0.009340342752575   0.156165705182621
    4   0.017870745434866   0.160459227209418
    5   0.029141100831243   0.157833390206324
    6   0.043103594816730   0.151126918069830
    7   0.059690257935624   0.141978734962672
    8   0.078814978080940   0.131427129313022
    9   0.100374843362374   0.120169213151007
    10  0.124251233458652   0.108690050821019
    11  0.150310823319684   0.097333650698496
    12  0.178406572113624   0.086345110970585
    13  0.208378732027199   0.075897263990631
    14  0.240055893384047   0.066108452722889
    15  0.273256073107231   0.057054968845518
    16  0.307787848247445   0.048780135326969
    17  0.343451533113967   0.041301197466255
    18  0.380040396522862   0.034614730691338
    19  0.417341914330888   0.028701008962378
    20  0.455139051495079   0.023527618658139
    21  0.493211567242711   0.019052504390898
    22  0.531337336470804   0.015226570732274
    23  0.569293680168549   0.011995923407948
    24  0.606858697439291   0.009303806970138
    25  0.643812591571502   0.007092278358123
    26  0.679938982557982   0.005303644058252
    27  0.715026198481030   0.003881680839129
    28  0.748868538263425   0.002772655007931
    29  0.781267498428097   0.001926151976128
    30  0.812032956714113   0.001295726072580
    31  0.840984305669462   0.000839379609339
    32  0.867951529701627   0.000519879915638
    33  0.892776219567142   0.000304923211442
    34  0.915312519064272   0.000167154649196
    35  0.935428000181421   0.000084054503519
    36  0.953004466542159   0.000037701251993
    37  0.967938696011113   0.000014423103218
    38  0.980143176810235   0.000004350341946
    39  0.989547125989027   0.000000881637013
    40  0.996100198799301   0.000000078165783
    
    1   0.000448797230789   0.079412084797958
    2   0.002863743176724   0.120227864969661
    3   0.007472580719957   0.136973736570282
    4   0.014288795399632   0.142889769940632
    5   0.023299971981916   0.142740692715896
    6   0.034477447370902   0.138885029284403
    7   0.047779250073919   0.132690322698210
    8   0.063151503776824   0.125028305231930
    9   0.080529304021336   0.116489871765386
    10  0.099837383985378   0.107492204798495
    11  0.120990693832148   0.098337637463301
    12  0.143894949860442   0.089248493333103
    13  0.168447181097710   0.080388975566380
    14  0.194536287513316   0.071879625850580
    15  0.222043617088493   0.063807300655344
    16  0.250843565126355   0.056232327633949
    17  0.280804196907227   0.049193823523536
    18  0.311787893371681   0.042713774751944
    19  0.343652018581199   0.036800260739957
    20  0.376249607069379   0.031450066423046
    21  0.409430068746358   0.026650847463803
    22  0.443039908692630   0.022382958549859
    23  0.476923458937795   0.018621020470679
    24  0.510923619141852   0.015335278537374
    25  0.544882602966637   0.012492789246762
    26  0.578642686833388   0.010058461351638
    27  0.612046957702879   0.007995970071228
    28  0.644940056482826   0.006268558014830
    29  0.677168913660367   0.004839732807681
    30  0.708583473773287   0.003673868936701
    31  0.739037405370911   0.002736719656914
    32  0.768388793173291   0.001995843695529
    33  0.796500809215335   0.001420950803110
    34  0.823242359861509   0.000984169817301
    35  0.848488705699473   0.000660242741836
    36  0.872122051474283   0.000426648341131
    37  0.894032103425607   0.000263658862601
    38  0.914116591681553   0.000154333689953
    39  0.932281755859211   0.000084453973862
    40  0.948442793061117   0.000042402560342
    41  0.962524270148234   0.000018993824772
    42  0.974460510755284   0.000007258307489
    43  0.984196001885642   0.000002187324000
    44  0.991686051091295   0.000000442980480
    45  0.996899609726306   0.000000039256135
    
    1   0.000369570433119   0.068504136804909
    2   0.002347134219197   0.105151577875052
    3   0.006115571770995   0.121321128315539
    4   0.011687370845523   0.128125986014206
    5   0.019056082830034   0.129586021833051
    6   0.028203824821908   0.127695678926300
    7   0.039103519166679   0.123617666227836
    8   0.051719928318451   0.118092991974382
    9   0.066010270305174   0.111630546226554
    10  0.081924660297733   0.104588588861948
    11  0.099406475155824   0.097234493302991
    12  0.118392685022626   0.089763620635523
    13  0.138814173979560   0.082328865185079
    14  0.160596061423103   0.075041385762480
    15  0.183658030519096   0.067990500989898
    16  0.207914667166511   0.061237978454549
    17  0.233275811191679   0.054833878003905
    18  0.259646920438599   0.048808520509080
    19  0.286929447739133   0.043186012720081
    20  0.315021230287611   0.037975680674068
    21  0.343816890623593   0.033183830323399
    22  0.373208248195249   0.028805524868256
    23  0.403084740304811   0.024834759426066
    24  0.433333851108568   0.021257033108662
    25  0.463841547245645   0.018058012776293
    26  0.494492718594754   0.015217112796852
    27  0.525171622601351   0.012714715943295
    28  0.555762330575936   0.010526827220442
    29  0.586149174335211   0.008630943425451
    30  0.616217191539941   0.007001753076647
    31  0.645852568075473   0.005615774001052
    32  0.674943075822135   0.004448011377657
    33  0.703378504172559   0.003475504785264
    34  0.731051083670879   0.002674820983222
    35  0.757855900174449   0.002024664852130
    36  0.783691297972073   0.001504066542102
    37  0.808459270333679   0.001094214437320
    38  0.832065836015480   0.000777193141826
    39  0.854421400302878   0.000537192101604
    40  0.875441099243377   0.000359657965941
    41  0.895045125809644   0.000232021425044
    42  0.913159036852631   0.000143141823139
    43  0.929714039891706   0.000083678850721
    44  0.944647259136955   0.000045726421112
    45  0.957901980923149   0.000022936769507
    46  0.969427880858720   0.000010262444070
    47  0.979181241908920   0.000003919661657
    48  0.987125200529378   0.000001180004688
    49  0.993230209396203   0.000000238999866
    50  0.997476276077283   0.000000021149283
    
    **/
    std::vector<double> x;
    std::vector<double> u;
    
    if (size == 1) {
        x.push_back(0.125000000000000);   u.push_back(2.000000000000000);
    } else if (size == 2) {
        x.push_back(0.059850992523974);   u.push_back(1.669136108179106);
        x.push_back(0.453662520989539);   u.push_back(0.330863891820894);
    } else if (size == 3) {
        x.push_back(0.036263311146964);   u.push_back(1.363830383647107);
        x.push_back(0.273148602374171);   u.push_back(0.565815459643824);
        x.push_back(0.653711089636059);   u.push_back(0.070354156709070);
    } else if (size == 4) {
        x.push_back(0.024645131796122);   u.push_back(1.133015642179986);
        x.push_back(0.183193330997148);   u.push_back(0.661216678605847);
        x.push_back(0.461017107692196);   u.push_back(0.185792949953630);
        x.push_back(0.765590646563578);   u.push_back(0.019974729260537);
    } else if (size == 5) {
        x.push_back(0.017962448464788);   u.push_back(0.958853796977194);
        x.push_back(0.131718430619486);   u.push_back(0.683002058455358);
        x.push_back(0.339597192622686);   u.push_back(0.281566027150624);
        x.push_back(0.594598293478672);   u.push_back(0.069585641223328);
        x.push_back(0.832057599572553);   u.push_back(0.006992476193496);
    } else if (size == 6) {
        x.push_back(0.013730329045456);   u.push_back(0.824737352390369);
        x.push_back(0.099443147478445);   u.push_back(0.670166203464709);
        x.push_back(0.259667876215925);   u.push_back(0.345795954949999);
        x.push_back(0.468522989748694);   u.push_back(0.126993601775933);
        x.push_back(0.687424583530283);   u.push_back(0.029455518788039);
        x.push_back(0.874203776340771);   u.push_back(0.002851368630950);
    } else if (size == 7) {
        x.push_back(0.010866207505320);   u.push_back(0.719152901447146);
        x.push_back(0.077838279871025);   u.push_back(0.642001756147696);
        x.push_back(0.204687509451051);   u.push_back(0.383963955676743);
        x.push_back(0.376198829717809);   u.push_back(0.178116619803947);
        x.push_back(0.568389327329658);   u.push_back(0.061674286979541);
        x.push_back(0.753021289840870);   u.push_back(0.013786206682459);
        x.push_back(0.902433292255294);   u.push_back(0.001304273262468);
    } else if (size == 8) {
        x.push_back(0.008830809807049);   u.push_back(0.634347612357608);
        x.push_back(0.062647013654314);   u.push_back(0.607890578339138);
        x.push_back(0.165393747002955);   u.push_back(0.403648557987985);
        x.push_back(0.307647530932382);   u.push_back(0.218465465723771);
        x.push_back(0.473881164271694);   u.push_back(0.095931949047165);
        x.push_back(0.644925602762386);   u.push_back(0.032063757135490);
        x.push_back(0.800557615899960);   u.push_back(0.006999794339627);
        x.push_back(0.922202082495176);   u.push_back(0.000652285069217);
    } else if (size == 9) {
        x.push_back(0.007328880195715);   u.push_back(0.565030790401789);
        x.push_back(0.051547764155867);   u.push_back(0.572402457821754);
        x.push_back(0.136390198283372);   u.push_back(0.410942571804823);
        x.push_back(0.255769685793153);   u.push_back(0.248113368613029);
        x.push_back(0.399262221805764);   u.push_back(0.127526643494220);
        x.push_back(0.553560403203940);   u.push_back(0.054151818128134);
        x.push_back(0.703952669354882);   u.push_back(0.017683406345981);
        x.push_back(0.835889107857694);   u.push_back(0.003798664022004);
        x.push_back(0.936557217046754);   u.push_back(0.000350279368267);
    } else if (size == 10) {
        x.push_back(0.006186914698328);   u.push_back(0.507510063239781);
        x.push_back(0.043184964523230);   u.push_back(0.537737088312751);
        x.push_back(0.114393297847011);   u.push_back(0.410158149857278);
        x.push_back(0.215744326251233);   u.push_back(0.268682157083323);
        x.push_back(0.340016375817525);   u.push_back(0.154453615234289);
        x.push_back(0.477753066826457);   u.push_back(0.076896476225321);
        x.push_back(0.618154004584026);   u.push_back(0.031926984063151);
        x.push_back(0.750027750554594);   u.push_back(0.010257845595189);
        x.push_back(0.862765515603032);   u.push_back(0.002178281995578);
        x.push_back(0.947297511565912);   u.push_back(0.000199338393338);
    } else if (size == 11) {
        x.push_back(0.005297168366314);   u.push_back(0.459147734919141);
        x.push_back(0.036723005222904);   u.push_back(0.504903008503401);
        x.push_back(0.097323041240281);   u.push_back(0.404218308313853);
        x.push_back(0.184301719400151);   u.push_back(0.282052866883149);
        x.push_back(0.292518196160653);   u.push_back(0.176276639025742);
        x.push_back(0.415102577456842);   u.push_back(0.098298114709767);
        x.push_back(0.544017506575938);   u.push_back(0.047892730337592);
        x.push_back(0.670659374824876);   u.push_back(0.019569787229519);
        x.push_back(0.786485659409476);   u.push_back(0.006213530125986);
        x.push_back(0.883636267976582);   u.push_back(0.001308240047822);
        x.push_back(0.955536355773472);   u.push_back(0.000119039904028);
    } else if (size == 12) {
        x.push_back(0.004589693195255);   u.push_back(0.418017824113410);
        x.push_back(0.031623539733634);   u.push_back(0.474301816818489);
        x.push_back(0.083813985252297);   u.push_back(0.395074643575296);
        x.push_back(0.159194704226479);   u.push_back(0.289909029375661);
        x.push_back(0.254019121091356);   u.push_back(0.193310690801472);
        x.push_back(0.363194553791793);   u.push_back(0.117340969898672);
        x.push_back(0.480651247108805);   u.push_back(0.064088547272520);
        x.push_back(0.599734219851784);   u.push_back(0.030743793563541);
        x.push_back(0.713617876839584);   u.push_back(0.012414739799576);
        x.push_back(0.815726437770183);   u.push_back(0.003906701704437);
        x.push_back(0.900140606936052);   u.push_back(0.000817207431179);
        x.push_back(0.961991191180627);   u.push_back(0.000074035645748);
    } else if (size == 13) {
        x.push_back(0.004017386810443);   u.push_back(0.382685775564930);
        x.push_back(0.027526777614526);   u.push_back(0.446025576834930);
        x.push_back(0.072941331899235);   u.push_back(0.384023972274008);
        x.push_back(0.138851149246139);   u.push_back(0.293622412458649);
        x.push_back(0.222469426470852);   u.push_back(0.206162603999141);
        x.push_back(0.319951512542728);   u.push_back(0.133655150470531);
        x.push_back(0.426646611273461);   u.push_back(0.079522892306238);
        x.push_back(0.537360947246880);   u.push_back(0.042784206315023);
        x.push_back(0.646638294158882);   u.push_back(0.020286445898623);
        x.push_back(0.749049716936116);   u.push_back(0.008118217047679);
        x.push_back(0.839480441856746);   u.push_back(0.002537058667903);
        x.push_back(0.913402543012125);   u.push_back(0.000528015651117);
        x.push_back(0.967140495912293);   u.push_back(0.000047672511229);
    } else if (size == 14) {
        x.push_back(0.003547541993039);   u.push_back(0.352063804257835);
        x.push_back(0.024184699391199);   u.push_back(0.420011622371769);
        x.push_back(0.064061380204106);   u.push_back(0.371926638924532);
        x.push_back(0.122150405018770);   u.push_back(0.294264224535848);
        x.push_back(0.196341512203557);   u.push_back(0.215502049342987);
        x.push_back(0.283684337947141);   u.push_back(0.147241937015533);
        x.push_back(0.380565959543197);   u.push_back(0.093629955712507);
        x.push_back(0.482892583121109);   u.push_back(0.054901932538534);
        x.push_back(0.586283629455674);   u.push_back(0.029203758845266);
        x.push_back(0.686274808313256);   u.push_back(0.013723262912334);
        x.push_back(0.778523232293847);   u.push_back(0.005453016087803);
        x.push_back(0.859006678958644);   u.push_back(0.001694853207356);
        x.push_back(0.924210639223845);   u.push_back(0.000351312263340);
        x.push_back(0.971312969265969);   u.push_back(0.000031631984358);
    } else if (size == 15) {
        x.push_back(0.003156845392773);   u.push_back(0.325313756517612);
        x.push_back(0.021421742847487);   u.push_back(0.396124356207930);
        x.push_back(0.056715214649110);   u.push_back(0.359352222870137);
        x.push_back(0.108279002434823);   u.push_back(0.292653698867661);
        x.push_back(0.174489836879466);   u.push_back(0.221958850827702);
        x.push_back(0.253050105975383);   u.push_back(0.158292685726503);
        x.push_back(0.341116946761434);   u.push_back(0.106146626096786);
        x.push_back(0.435430905570579);   u.push_back(0.066550172994835);
        x.push_back(0.532453070244544);   u.push_back(0.038592931968205);
        x.push_back(0.628509787938396);   u.push_back(0.020347552748834);
        x.push_back(0.719941076797433);   u.push_back(0.009493859649710);
        x.push_back(0.803247767283529);   u.push_back(0.003751144925081);
        x.push_back(0.875232321594101);   u.push_back(0.001160773201865);
        x.push_back(0.933129879197034);   u.push_back(0.000239821843717);
        x.push_back(0.974740297547725);   u.push_back(0.000021545553422);
    } else if (size == 16) {
        x.push_back(0.002828300159798);   u.push_back(0.301780476891072);
        x.push_back(0.019110751099868);   u.push_back(0.374198712979551);
        x.push_back(0.050568668659265);   u.push_back(0.346675898392731);
        x.push_back(0.096636285322502);   u.push_back(0.289410876220393);
        x.push_back(0.156047462130955);   u.push_back(0.226084387325758);
        x.push_back(0.226989114165828);   u.push_back(0.167080600854540);
        x.push_back(0.307197679621559);   u.push_back(0.117004667764872);
        x.push_back(0.394052383477371);   u.push_back(0.077390026028989);
        x.push_back(0.484674055439231);   u.push_back(0.047999891808212);
        x.push_back(0.576029942951758);   u.push_back(0.027594767061093);
        x.push_back(0.665042420674438);   u.push_back(0.014446574428494);
        x.push_back(0.748698526989689);   u.push_back(0.006702011552565);
        x.push_back(0.824156928544244);   u.push_back(0.002635892263672);
        x.push_back(0.888849085545880);   u.push_back(0.000812733709037);
        x.push_back(0.940572876994778);   u.push_back(0.000167465136962);
        x.push_back(0.977589501930006);   u.push_back(0.000015017582059);
    } else if (size == 17) {
        x.push_back(0.002549268181483);   u.push_back(0.280945189211177);
        x.push_back(0.017157760439066);   u.push_back(0.354063079756389);
        x.push_back(0.045373808776699);   u.push_back(0.334142213002512);
        x.push_back(0.086771672296615);   u.push_back(0.285002656880030);
        x.push_back(0.140351489687455);   u.push_back(0.228343528635447);
        x.push_back(0.204665369064385);   u.push_back(0.173900284191252);
        x.push_back(0.277891281023551);   u.push_back(0.126251800625624);
        x.push_back(0.357902136731521);   u.push_back(0.087238920904915);
        x.push_back(0.442338317555793);   u.push_back(0.057098628131991);
        x.push_back(0.528684772985160);   u.push_back(0.035114826064380);
        x.push_back(0.614351643449972);   u.push_back(0.020047111752487);
        x.push_back(0.696756523837162);   u.push_back(0.010435166524718);
        x.push_back(0.773406135541422);   u.push_back(0.004818355481427);
        x.push_back(0.841975100464489);   u.push_back(0.001887874661047);
        x.push_back(0.900379750480077);   u.push_back(0.000580362187371);
        x.push_back(0.946846241320669);   u.push_back(0.000119318281341);
        x.push_back(0.979983398435209);   u.push_back(0.000010683707891);
    } else if (size == 18) {
        x.push_back(0.002310188032613);   u.push_back(0.262392283299750);
        x.push_back(0.015492096309324);   u.push_back(0.335551049338251);
        x.push_back(0.040943580985919);   u.push_back(0.321907525033010);
        x.push_back(0.078342213590741);   u.push_back(0.279779774934759);
        x.push_back(0.126889643277628);   u.push_back(0.229119949034927);
        x.push_back(0.185417079250863);   u.push_back(0.179036252330030);
        x.push_back(0.252443163436784);   u.push_back(0.133998739377536);
        x.push_back(0.326226163635375);   u.push_back(0.096023028179669);
        x.push_back(0.404818128973814);   u.push_back(0.065674237156783);
        x.push_back(0.486122442494718);   u.push_back(0.042628774106851);
        x.push_back(0.567954350784091);   u.push_back(0.026037168698314);
        x.push_back(0.648103328051837);   u.push_back(0.014780307510249);
        x.push_back(0.724395813272138);   u.push_back(0.007657312937060);
        x.push_back(0.794756734165206);   u.push_back(0.003521927920280);
        x.push_back(0.857268249207097);   u.push_back(0.001375557344909);
        x.push_back(0.910224382884338);   u.push_back(0.000421812825376);
        x.push_back(0.952181419425838);   u.push_back(0.000086559395914);
        x.push_back(0.982013901306222);   u.push_back(0.000007740576331);
    } else if (size == 19) {
        x.push_back(0.002103713861697);   u.push_back(0.245785256334609);
        x.push_back(0.014059758822520);   u.push_back(0.318507057153833);
        x.push_back(0.037134731295323);   u.push_back(0.310068443540299);
        x.push_back(0.071083378999791);   u.push_back(0.274005366711849);
        x.push_back(0.115261901980441);   u.push_back(0.228726383232054);
        x.push_back(0.168717532070917);   u.push_back(0.182748199774754);
        x.push_back(0.230234772687100);   u.push_back(0.140385553704615);
        x.push_back(0.298375567087281);   u.push_back(0.103739776664728);
        x.push_back(0.371520386749633);   u.push_back(0.073598876921954);
        x.push_back(0.447911795471924);   u.push_back(0.049930263605688);
        x.push_back(0.525700436623872);   u.push_back(0.032192414617895);
        x.push_back(0.602992768341327);   u.push_back(0.019552542607783);
        x.push_back(0.677899590280704);   u.push_back(0.011046958150578);
        x.push_back(0.748584276920761);   u.push_back(0.005700569568147);
        x.push_back(0.813309594947041);   u.push_back(0.002613348432719);
        x.push_back(0.870482031064796);   u.push_back(0.001017968153145);
        x.push_back(0.918692783605593);   u.push_back(0.000311499200016);
        x.push_back(0.956755632904915);   u.push_back(0.000063820663927);
        x.push_back(0.983750888184430);   u.push_back(0.000005700961408);
    } else if (size == 20) {
        x.push_back(0.001924123896548);   u.push_back(0.230849018934113);
        x.push_back(0.012818904308203);   u.push_back(0.302788672475958);
        x.push_back(0.033836058479442);   u.push_back(0.298681032937715);
        x.push_back(0.064788617704556);   u.push_back(0.267876635676885);
        x.push_back(0.105152759394186);   u.push_back(0.227415866573449);
        x.push_back(0.154144860255520);   u.push_back(0.185265564670212);
        x.push_back(0.210759108843122);   u.push_back(0.145561250500400);
        x.push_back(0.273798950815432);   u.push_back(0.110430575318355);
        x.push_back(0.341908732802284);   u.push_back(0.080808744909874);
        x.push_back(0.413607113229689);   u.push_back(0.056876627612354);
        x.push_back(0.487322401720604);   u.push_back(0.038332342971330);
        x.push_back(0.561429448570056);   u.push_back(0.024578224251546);
        x.push_back(0.634287460375067);   u.push_back(0.014858188164593);
        x.push_back(0.704277998456032);   u.push_back(0.008361471530632);
        x.push_back(0.769842365279614);   u.push_back(0.004300377014631);
        x.push_back(0.829517582062234);   u.push_back(0.001965964030976);
        x.push_back(0.881970217477923);   u.push_back(0.000764052041239);
        x.push_back(0.926027532208401);   u.push_back(0.000233378737216);
        x.push_back(0.960706355433472);   u.push_back(0.000047750199250);
        x.push_back(0.985248238975239);   u.push_back(0.000004261449274);
    } else if (size == 21) {
        x.push_back(0.001766905955418);   u.push_back(0.217356699998702);
        x.push_back(0.011736695821766);   u.push_back(0.288267084421689);
        x.push_back(0.030960181001045);   u.push_back(0.287773876275508);
        x.push_back(0.059294831367867);   u.push_back(0.261541139618741);
        x.push_back(0.096310990839680);   u.push_back(0.225392242247653);
        x.push_back(0.141358885591997);   u.push_back(0.186787027524898);
        x.push_back(0.193599713059551);   u.push_back(0.149671985619717);
        x.push_back(0.252030650182987);   u.push_back(0.116161908835494);
        x.push_back(0.315509567026290);   u.push_back(0.087284943082145);
        x.push_back(0.382780969115272);   u.push_back(0.063376691720770);
        x.push_back(0.452503451415981);   u.push_back(0.044320019451470);
        x.push_back(0.523278474766461);   u.push_back(0.029707537861143);
        x.push_back(0.593680061418344);   u.push_back(0.018960092226938);
        x.push_back(0.662284899256680);   u.push_back(0.011416660413419);
        x.push_back(0.727702291598452);   u.push_back(0.006403135962611);
        x.push_back(0.788603371442317);   u.push_back(0.003283804612008);
        x.push_back(0.843749010989284);   u.push_back(0.001497647349735);
        x.push_back(0.892015912851959);   u.push_back(0.000580907132928);
        x.push_back(0.932420552421345);   u.push_back(0.000177161617223);
        x.push_back(0.964141498191094);   u.push_back(0.000036205480238);
        x.push_back(0.986548031528898);   u.push_back(0.000003228546969);
    } else if (size == 22) {
        x.push_back(0.001628461746230);   u.push_back(0.205119680180875);
        x.push_back(0.010787067722103);   u.push_back(0.274826646331061);
        x.push_back(0.028437667614839);   u.push_back(0.277357019193801);
        x.push_back(0.054471898085992);   u.push_back(0.255108995555831);
        x.push_back(0.088534754664349);   u.push_back(0.222819309409679);
        x.push_back(0.130083417273674);   u.push_back(0.187482444629131);
        x.push_back(0.178413317623272);   u.push_back(0.152854727798978);
        x.push_back(0.232678321058697);   u.push_back(0.121012705724115);
        x.push_back(0.291910282420350);   u.push_back(0.093038693466611);
        x.push_back(0.355039425095198);   u.push_back(0.069378785680193);
        x.push_back(0.420915890810131);   u.push_back(0.050057104798575);
        x.push_back(0.488332391924356);   u.push_back(0.034818658577368);
        x.push_back(0.556047710367844);   u.push_back(0.023232423316187);
        x.push_back(0.622810692544012);   u.push_back(0.014769464328093);
        x.push_back(0.687384339963150);   u.push_back(0.008863374800985);
        x.push_back(0.748569572531227);   u.push_back(0.004956761557497);
        x.push_back(0.805228238209401);   u.push_back(0.002535803622026);
        x.push_back(0.856304959469968);   u.push_back(0.001154123792461);
        x.push_back(0.900847458207418);   u.push_back(0.000446903172399);
        x.push_back(0.938025164302648);   u.push_back(0.000136110161355);
        x.push_back(0.967146690015904);   u.push_back(0.000027787723476);
        x.push_back(0.987683509211338);   u.push_back(0.000002476179303);
    } else if (size == 23) {
        x.push_back(0.001505892474584);   u.push_back(0.193979975198118);
        x.push_back(0.009949112846861);   u.push_back(0.262363963659648);
        x.push_back(0.026212787562514);   u.push_back(0.267428126763970);
        x.push_back(0.050215014094684);   u.push_back(0.248662024728409);
        x.push_back(0.081660512821456);   u.push_back(0.219828495609352);
        x.push_back(0.120092694277137);   u.push_back(0.187495823926848);
        x.push_back(0.164915797166005);   u.push_back(0.155234272915304);
        x.push_back(0.215411397226014);   u.push_back(0.125066174707640);
        x.push_back(0.270754073298502);   u.push_back(0.098100418872551);
        x.push_back(0.330027592716307);   u.push_back(0.074860364849399);
        x.push_back(0.392241993524124);   u.push_back(0.055477247414685);
        x.push_back(0.456351572232027);   u.push_back(0.039817159733692);
        x.push_back(0.521273620526389);   u.push_back(0.027571576765108);
        x.push_back(0.585907670629421);   u.push_back(0.018325604666402);
        x.push_back(0.649154963911799);   u.push_back(0.011611019656801);
        x.push_back(0.709937833943106);   u.push_back(0.006947749930384);
        x.push_back(0.767218686284763);   u.push_back(0.003875771461057);
        x.push_back(0.820018260579743);   u.push_back(0.001978563506850);
        x.push_back(0.867432877982759);   u.push_back(0.000898892530630);
        x.push_back(0.908650423041717);   u.push_back(0.000347557889758);
        x.push_back(0.942964955771737);   u.push_back(0.000105728680567);
        x.push_back(0.969790557585917);   u.push_back(0.000021565953939);
        x.push_back(0.988681214124179);   u.push_back(0.000001920578888);
    } else if (size == 24) {
        x.push_back(0.001396841108628);   u.push_back(0.183804351696878);
        x.push_back(0.009205901459614);   u.push_back(0.250786796254170);
        x.push_back(0.024240389461507);   u.push_back(0.257976738859653);
        x.push_back(0.046439023937117);   u.push_back(0.242260616648736);
        x.push_back(0.075554710625806);   u.push_back(0.216525156766932);
        x.push_back(0.111200959344884);   u.push_back(0.186948592457721);
        x.push_back(0.152870900608033);   u.push_back(0.156922256030170);
        x.push_back(0.199950960142270);   u.push_back(0.128404723657879);
        x.push_back(0.251733554740276);   u.push_back(0.102511933558023);
        x.push_back(0.307430080774664);   u.push_back(0.079819615070583);
        x.push_back(0.366184581724246);   u.push_back(0.060539452318891);
        x.push_back(0.427088151776252);   u.push_back(0.044633098352965);
        x.push_back(0.489193986071764);   u.push_back(0.031892422317387);
        x.push_back(0.551532914108179);   u.push_back(0.021999542986404);
        x.push_back(0.613129212357411);   u.push_back(0.014573473100979);
        x.push_back(0.673016469852419);   u.push_back(0.009206944902854);
        x.push_back(0.730253269666416);   u.push_back(0.005495349989307);
        x.push_back(0.783938446986591);   u.push_back(0.003058892932763);
        x.push_back(0.833225690302863);   u.push_back(0.001558645578986);
        x.push_back(0.877337268846226);   u.push_back(0.000707005965498);
        x.push_back(0.915576710477130);   u.push_back(0.000273010686377);
        x.push_back(0.947340386377785);   u.push_back(0.000082965226514);
        x.push_back(0.972128607064410);   u.push_back(0.000016909552383);
        x.push_back(0.989562543370083);   u.push_back(0.000001505087947);
    } else if (size == 25) {
        x.push_back(0.001299374768187);   u.push_back(0.174479735931546);
        x.push_back(0.008543604574282);   u.push_back(0.240012923532223);
        x.push_back(0.022483579082068);   u.push_back(0.248987218262273);
        x.push_back(0.043074172979132);   u.push_back(0.235948895302534);
        x.push_back(0.070107468665480);   u.push_back(0.212993687043331);
        x.push_back(0.103254398760380);   u.push_back(0.185942770543868);
        x.push_back(0.142081248606511);   u.push_back(0.158017307953912);
        x.push_back(0.186061114941111);   u.push_back(0.131106955278190);
        x.push_back(0.234584307062143);   u.push_back(0.106321004742672);
        x.push_back(0.286968872412906);   u.push_back(0.084268943142606);
        x.push_back(0.342471629050440);   u.push_back(0.065222155885247);
        x.push_back(0.400299791724139);   u.push_back(0.049217229847254);
        x.push_back(0.459623147645393);   u.push_back(0.036127743151150);
        x.push_back(0.519586672291463);   u.push_back(0.025717471448905);
        x.push_back(0.579323439467549);   u.push_back(0.017681582859112);
        x.push_back(0.637967659284094);   u.push_back(0.011679297675091);
        x.push_back(0.694667666557350);   u.push_back(0.007359910450342);
        x.push_back(0.748598677599054);   u.push_back(0.004383248044841);
        x.push_back(0.798975134269998);   u.push_back(0.002435209263362);
        x.push_back(0.845062460733556);   u.push_back(0.001238820802901);
        x.push_back(0.886188073485450);   u.push_back(0.000561155826571);
        x.push_back(0.921751521808573);   u.push_back(0.000216443029659);
        x.push_back(0.951233755582807);   u.push_back(0.000065714826168);
        x.push_back(0.974206113448563);   u.push_back(0.000013384402252);
        x.push_back(0.990344899854832);   u.push_back(0.000001190753989);
    } else if (size == 26) {
        x.push_back(0.001211895953144);   u.push_back(0.165909597900741);
        x.push_back(0.007950835083421);   u.push_back(0.229969050948748);
        x.push_back(0.020911970701015);   u.push_back(0.240440793791640);
        x.push_back(0.040062890303616);   u.push_back(0.229758620259279);
        x.push_back(0.065227756094948);   u.push_back(0.209301634430997);
        x.push_back(0.096124873966381);   u.push_back(0.184563873212425);
        x.push_back(0.132381145124222);   u.push_back(0.158605827354705);
        x.push_back(0.173541771179187);   u.push_back(0.133246033424505);
        x.push_back(0.219078862911660);   u.push_back(0.109577661754471);
        x.push_back(0.268400049319685);   u.push_back(0.088230076743001);
        x.push_back(0.320857458070521);   u.push_back(0.069518256800207);
        x.push_back(0.375757171448330);   u.push_back(0.053537150852984);
        x.push_back(0.432369144701918);   u.push_back(0.040226455838505);
        x.push_back(0.489937515066220);   u.push_back(0.029418139625084);
        x.push_back(0.547691197495453);   u.push_back(0.020873023457482);
        x.push_back(0.604854644468783);   u.push_back(0.014309796296644);
        x.push_back(0.660658636490247);   u.push_back(0.009428319627520);
        x.push_back(0.714350964474867);   u.push_back(0.005928277523599);
        x.push_back(0.765206863851496);   u.push_back(0.003523795966772);
        x.push_back(0.812539062502577);   u.push_back(0.001954429587142);
        x.push_back(0.855707311124978);   u.push_back(0.000992804711503);
        x.push_back(0.894127278139190);   u.push_back(0.000449166032353);
        x.push_back(0.927278723938938);   u.push_back(0.000173072023045);
        x.push_back(0.954712978447157);   u.push_back(0.000052504259616);
        x.push_back(0.976060296284965);   u.push_back(0.000010687185195);
        x.push_back(0.991042553891775);   u.push_back(0.000000950391839);
    } else if (size == 30) {
        x.push_back(0.000938253265447);   u.push_back(0.137676443941630);
        x.push_back(0.006107726543114);   u.push_back(0.195885975601622);
        x.push_back(0.016031080676759);   u.push_back(0.210268725136789);
        x.push_back(0.030705186162534);   u.push_back(0.206561492289121);
        x.push_back(0.050036197942358);   u.push_back(0.193856500144686);
        x.push_back(0.073865597603489);   u.push_back(0.176584044933802);
        x.push_back(0.101979339965684);   u.push_back(0.157256165869557);
        x.push_back(0.134113324110492);   u.push_back(0.137415766886845);
        x.push_back(0.169957816772565);   u.push_back(0.118046532595713);
        x.push_back(0.209161640244516);   u.push_back(0.099777943557785);
        x.push_back(0.251336426144445);   u.push_back(0.082999750605787);
        x.push_back(0.296061051010481);   u.push_back(0.067931912187925);
        x.push_back(0.342886289952091);   u.push_back(0.054670739318578);
        x.push_back(0.391339685613067);   u.push_back(0.043221425989051);
        x.push_back(0.440930608618850);   u.push_back(0.033522285387789);
        x.push_back(0.491155473348428);   u.push_back(0.025463611447442);
        x.push_back(0.541503065266541);   u.push_back(0.018902826458941);
        x.push_back(0.591459931268120);   u.push_back(0.013676886808064);
        x.push_back(0.640515781563337);   u.push_back(0.009612528011925);
        x.push_back(0.688168850061483);   u.push_back(0.006534705005718);
        x.push_back(0.733931159722301);   u.push_back(0.004273451964695);
        x.push_back(0.777333639800269);   u.push_back(0.002669310941103);
        x.push_back(0.817931043294885);   u.push_back(0.001577437115953);
        x.push_back(0.855306615414549);   u.push_back(0.000870468589335);
        x.push_back(0.889076468144764);   u.push_back(0.000440241650354);
        x.push_back(0.918893624471120);   u.push_back(0.000198433961056);
        x.push_back(0.944451717719704);   u.push_back(0.000076224316174);
        x.push_back(0.965488410519963);   u.push_back(0.000023066690603);
        x.push_back(0.981789011002416);   u.push_back(0.000004686380402);
        x.push_back(0.993194470701601);   u.push_back(0.000000416211557);
    } else if (size == 35) {
        x.push_back(0.000710288160721);   u.push_back(0.112092876985421);
        x.push_back(0.004587102256450);   u.push_back(0.163605423965229);
        x.push_back(0.012012783293299);   u.push_back(0.180057148429348);
        x.push_back(0.022997219083556);   u.push_back(0.181471124457663);
        x.push_back(0.037494445348316);   u.push_back(0.174971287793732);
        x.push_back(0.055420399987502);   u.push_back(0.164053261027971);
        x.push_back(0.076658733330740);   u.push_back(0.150722110311121);
        x.push_back(0.101063934846327);   u.push_back(0.136234748428706);
        x.push_back(0.128463607203279);   u.push_back(0.121420715568996);
        x.push_back(0.158660460020927);   u.push_back(0.106841864276382);
        x.push_back(0.191434244320567);   u.push_back(0.092880478278897);
        x.push_back(0.226543722395174);   u.push_back(0.079792025456380);
        x.push_back(0.263728714255856);   u.push_back(0.067738974224230);
        x.push_back(0.302712236149867);   u.push_back(0.056813802853714);
        x.push_back(0.343202733087210);   u.push_back(0.047055502143372);
        x.push_back(0.384896399547925);   u.push_back(0.038461968941276);
        x.push_back(0.427479577789020);   u.push_back(0.030999683895043);
        x.push_back(0.470631220106360);   u.push_back(0.024611510338003);
        x.push_back(0.514025399364001);   u.push_back(0.019223130211810);
        x.push_back(0.557333850725481);   u.push_back(0.014748441657154);
        x.push_back(0.600228526610458);   u.push_back(0.011094126050064);
        x.push_back(0.642384146341758);   u.push_back(0.008163519610316);
        x.push_back(0.683480721674270);   u.push_back(0.005859879132167);
        x.push_back(0.723206039367624);   u.push_back(0.004089102843288);
        x.push_back(0.761258082155899);   u.push_back(0.002761949813728);
        x.push_back(0.797347369872117);   u.push_back(0.001795790936293);
        x.push_back(0.831199203116472);   u.push_back(0.001115918869016);
        x.push_back(0.862555792773512);   u.push_back(0.000656441886258);
        x.push_back(0.891178260062636);   u.push_back(0.000360786261700);
        x.push_back(0.916848494189018);   u.push_back(0.000181832868912);
        x.push_back(0.939370859849387);   u.push_back(0.000081715613329);
        x.push_back(0.958573761748160);   u.push_back(0.000031311727232);
        x.push_back(0.974311130330776);   u.push_back(0.000009456588660);
        x.push_back(0.986464197666822);   u.push_back(0.000001918357355);
        x.push_back(0.994946681075095);   u.push_back(0.000000170197233);
    } else if (size == 40) {
        x.push_back(0.000556967498706);   u.push_back(0.093465963789691);
        x.push_back(0.003573534297375);   u.push_back(0.139195760758708);
        x.push_back(0.009340342752575);   u.push_back(0.156165705182621);
        x.push_back(0.017870745434866);   u.push_back(0.160459227209418);
        x.push_back(0.029141100831243);   u.push_back(0.157833390206324);
        x.push_back(0.043103594816730);   u.push_back(0.151126918069830);
        x.push_back(0.059690257935624);   u.push_back(0.141978734962672);
        x.push_back(0.078814978080940);   u.push_back(0.131427129313022);
        x.push_back(0.100374843362374);   u.push_back(0.120169213151007);
        x.push_back(0.124251233458652);   u.push_back(0.108690050821019);
        x.push_back(0.150310823319684);   u.push_back(0.097333650698496);
        x.push_back(0.178406572113624);   u.push_back(0.086345110970585);
        x.push_back(0.208378732027199);   u.push_back(0.075897263990631);
        x.push_back(0.240055893384047);   u.push_back(0.066108452722889);
        x.push_back(0.273256073107231);   u.push_back(0.057054968845518);
        x.push_back(0.307787848247445);   u.push_back(0.048780135326969);
        x.push_back(0.343451533113967);   u.push_back(0.041301197466255);
        x.push_back(0.380040396522862);   u.push_back(0.034614730691338);
        x.push_back(0.417341914330888);   u.push_back(0.028701008962378);
        x.push_back(0.455139051495079);   u.push_back(0.023527618658139);
        x.push_back(0.493211567242711);   u.push_back(0.019052504390898);
        x.push_back(0.531337336470804);   u.push_back(0.015226570732274);
        x.push_back(0.569293680168549);   u.push_back(0.011995923407948);
        x.push_back(0.606858697439291);   u.push_back(0.009303806970138);
        x.push_back(0.643812591571502);   u.push_back(0.007092278358123);
        x.push_back(0.679938982557982);   u.push_back(0.005303644058252);
        x.push_back(0.715026198481030);   u.push_back(0.003881680839129);
        x.push_back(0.748868538263425);   u.push_back(0.002772655007931);
        x.push_back(0.781267498428097);   u.push_back(0.001926151976128);
        x.push_back(0.812032956714113);   u.push_back(0.001295726072580);
        x.push_back(0.840984305669462);   u.push_back(0.000839379609339);
        x.push_back(0.867951529701627);   u.push_back(0.000519879915638);
        x.push_back(0.892776219567142);   u.push_back(0.000304923211442);
        x.push_back(0.915312519064272);   u.push_back(0.000167154649196);
        x.push_back(0.935428000181421);   u.push_back(0.000084054503519);
        x.push_back(0.953004466542159);   u.push_back(0.000037701251993);
        x.push_back(0.967938696011113);   u.push_back(0.000014423103218);
        x.push_back(0.980143176810235);   u.push_back(0.000004350341946);
        x.push_back(0.989547125989027);   u.push_back(0.000000881637013);
        x.push_back(0.996100198799301);   u.push_back(0.000000078165783);
    } else if (size == 45) {
        x.push_back(0.000448797230789);   u.push_back(0.079412084797958);
        x.push_back(0.002863743176724);   u.push_back(0.120227864969661);
        x.push_back(0.007472580719957);   u.push_back(0.136973736570282);
        x.push_back(0.014288795399632);   u.push_back(0.142889769940632);
        x.push_back(0.023299971981916);   u.push_back(0.142740692715896);
        x.push_back(0.034477447370902);   u.push_back(0.138885029284403);
        x.push_back(0.047779250073919);   u.push_back(0.132690322698210);
        x.push_back(0.063151503776824);   u.push_back(0.125028305231930);
        x.push_back(0.080529304021336);   u.push_back(0.116489871765386);
        x.push_back(0.099837383985378);   u.push_back(0.107492204798495);
        x.push_back(0.120990693832148);   u.push_back(0.098337637463301);
        x.push_back(0.143894949860442);   u.push_back(0.089248493333103);
        x.push_back(0.168447181097710);   u.push_back(0.080388975566380);
        x.push_back(0.194536287513316);   u.push_back(0.071879625850580);
        x.push_back(0.222043617088493);   u.push_back(0.063807300655344);
        x.push_back(0.250843565126355);   u.push_back(0.056232327633949);
        x.push_back(0.280804196907227);   u.push_back(0.049193823523536);
        x.push_back(0.311787893371681);   u.push_back(0.042713774751944);
        x.push_back(0.343652018581199);   u.push_back(0.036800260739957);
        x.push_back(0.376249607069379);   u.push_back(0.031450066423046);
        x.push_back(0.409430068746358);   u.push_back(0.026650847463803);
        x.push_back(0.443039908692630);   u.push_back(0.022382958549859);
        x.push_back(0.476923458937795);   u.push_back(0.018621020470679);
        x.push_back(0.510923619141852);   u.push_back(0.015335278537374);
        x.push_back(0.544882602966637);   u.push_back(0.012492789246762);
        x.push_back(0.578642686833388);   u.push_back(0.010058461351638);
        x.push_back(0.612046957702879);   u.push_back(0.007995970071228);
        x.push_back(0.644940056482826);   u.push_back(0.006268558014830);
        x.push_back(0.677168913660367);   u.push_back(0.004839732807681);
        x.push_back(0.708583473773287);   u.push_back(0.003673868936701);
        x.push_back(0.739037405370911);   u.push_back(0.002736719656914);
        x.push_back(0.768388793173291);   u.push_back(0.001995843695529);
        x.push_back(0.796500809215335);   u.push_back(0.001420950803110);
        x.push_back(0.823242359861509);   u.push_back(0.000984169817301);
        x.push_back(0.848488705699473);   u.push_back(0.000660242741836);
        x.push_back(0.872122051474283);   u.push_back(0.000426648341131);
        x.push_back(0.894032103425607);   u.push_back(0.000263658862601);
        x.push_back(0.914116591681553);   u.push_back(0.000154333689953);
        x.push_back(0.932281755859211);   u.push_back(0.000084453973862);
        x.push_back(0.948442793061117);   u.push_back(0.000042402560342);
        x.push_back(0.962524270148234);   u.push_back(0.000018993824772);
        x.push_back(0.974460510755284);   u.push_back(0.000007258307489);
        x.push_back(0.984196001885642);   u.push_back(0.000002187324000);
        x.push_back(0.991686051091295);   u.push_back(0.000000442980480);
        x.push_back(0.996899609726306);   u.push_back(0.000000039256135);
    } else if (size == 50) {
        x.push_back(0.000369570433119);   u.push_back(0.068504136804909);
        x.push_back(0.002347134219197);   u.push_back(0.105151577875052);
        x.push_back(0.006115571770995);   u.push_back(0.121321128315539);
        x.push_back(0.011687370845523);   u.push_back(0.128125986014206);
        x.push_back(0.019056082830034);   u.push_back(0.129586021833051);
        x.push_back(0.028203824821908);   u.push_back(0.127695678926300);
        x.push_back(0.039103519166679);   u.push_back(0.123617666227836);
        x.push_back(0.051719928318451);   u.push_back(0.118092991974382);
        x.push_back(0.066010270305174);   u.push_back(0.111630546226554);
        x.push_back(0.081924660297733);   u.push_back(0.104588588861948);
        x.push_back(0.099406475155824);   u.push_back(0.097234493302991);
        x.push_back(0.118392685022626);   u.push_back(0.089763620635523);
        x.push_back(0.138814173979560);   u.push_back(0.082328865185079);
        x.push_back(0.160596061423103);   u.push_back(0.075041385762480);
        x.push_back(0.183658030519096);   u.push_back(0.067990500989898);
        x.push_back(0.207914667166511);   u.push_back(0.061237978454549);
        x.push_back(0.233275811191679);   u.push_back(0.054833878003905);
        x.push_back(0.259646920438599);   u.push_back(0.048808520509080);
        x.push_back(0.286929447739133);   u.push_back(0.043186012720081);
        x.push_back(0.315021230287611);   u.push_back(0.037975680674068);
        x.push_back(0.343816890623593);   u.push_back(0.033183830323399);
        x.push_back(0.373208248195249);   u.push_back(0.028805524868256);
        x.push_back(0.403084740304811);   u.push_back(0.024834759426066);
        x.push_back(0.433333851108568);   u.push_back(0.021257033108662);
        x.push_back(0.463841547245645);   u.push_back(0.018058012776293);
        x.push_back(0.494492718594754);   u.push_back(0.015217112796852);
        x.push_back(0.525171622601351);   u.push_back(0.012714715943295);
        x.push_back(0.555762330575936);   u.push_back(0.010526827220442);
        x.push_back(0.586149174335211);   u.push_back(0.008630943425451);
        x.push_back(0.616217191539941);   u.push_back(0.007001753076647);
        x.push_back(0.645852568075473);   u.push_back(0.005615774001052);
        x.push_back(0.674943075822135);   u.push_back(0.004448011377657);
        x.push_back(0.703378504172559);   u.push_back(0.003475504785264);
        x.push_back(0.731051083670879);   u.push_back(0.002674820983222);
        x.push_back(0.757855900174449);   u.push_back(0.002024664852130);
        x.push_back(0.783691297972073);   u.push_back(0.001504066542102);
        x.push_back(0.808459270333679);   u.push_back(0.001094214437320);
        x.push_back(0.832065836015480);   u.push_back(0.000777193141826);
        x.push_back(0.854421400302878);   u.push_back(0.000537192101604);
        x.push_back(0.875441099243377);   u.push_back(0.000359657965941);
        x.push_back(0.895045125809644);   u.push_back(0.000232021425044);
        x.push_back(0.913159036852631);   u.push_back(0.000143141823139);
        x.push_back(0.929714039891706);   u.push_back(0.000083678850721);
        x.push_back(0.944647259136955);   u.push_back(0.000045726421112);
        x.push_back(0.957901980923149);   u.push_back(0.000022936769507);
        x.push_back(0.969427880858720);   u.push_back(0.000010262444070);
        x.push_back(0.979181241908920);   u.push_back(0.000003919661657);
        x.push_back(0.987125200529378);   u.push_back(0.000001180004688);
        x.push_back(0.993230209396203);   u.push_back(0.000000238999866);
        x.push_back(0.997476276077283);   u.push_back(0.000000021149283);
    } else {
        throw std::runtime_error("MultiExpHelper: Not a valid MultiExp size.");
    } 
    
    std::vector<size_t> dim;
    dim.push_back(size);
    dim.push_back(2);
    std::shared_ptr<Tensor> rw(new Tensor(dim));
    double* rwp = rw->data().data();
    for (int i = 0; i < size; i++) {
        // Reverse to order on [0,\infty)
        rwp[2*i + 0] = -a * log(x[size - i - 1]);
        rwp[2*i + 1] = a*a*a * u[size - i - 1] / x[size - i - 1];
    }
    return std::shared_ptr<RadialGrid>(new RadialGrid("MULTIEXP", a, rw));
}
std::string RadialGrid::string() const
{
    std::string str = "";
    str += sprintf2("Radial Grid:\n");
    str += sprintf2("  Name   = %8s\n", name_.c_str());
    str += sprintf2("  Size   = %8zu\n", size());
    str += sprintf2("  R      = %8.6f", R());
    return str;
}

} // namespace lightspeed 
